<mxfile host="app.diagrams.net" modified="2023-12-29T14:51:08.476Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" etag="Ih638h9LvlBxhqZgeVmB" version="22.1.15" type="github" pages="3">
  <diagram id="Cw5CgzrS2XZY5D7zUyKp" name="OSインストール">
    <mxGraphModel dx="1647" dy="839" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="szrl0G2C0kDdJWEc9u8A-1" value="### 1. NICに固定IPを設定&#xa;1. **ネットワーク設定ファイルの編集**:&#xa;   - nmtui&#xa;   - IPADDR、NETMASK、GATEWAY、DNS1（必要に応じて）を適切な値に設定&#xa;&#xa;&#xa;2. **ネットワークサービスの再起動**:&#xa;   - `sudo systemctl restart network`&#xa;&#xa;&#xa;### 2. インターネット接続の確認&#xa;- **pingコマンドで外部接続を確認**:&#xa;[admin@localhost ~]$ ping www.i2c.jp&#xa;PING www.i2c.jp (163.44.185.163) 56(84) bytes of data.&#xa;64 bytes from 163-44-185-163.virt.lolipop.jp (163.44.185.163): icmp_seq=1 ttl=128 time=21.3 ms&#xa;64 bytes from 163-44-185-163.virt.lolipop.jp (163.44.185.163): icmp_seq=2 ttl=128 time=21.3 ms&#xa;64 bytes from 163-44-185-163.virt.lolipop.jp (163.44.185.163): icmp_seq=3 ttl=128 time=26.5 ms&#xa;  &#xa;&#xa;&#xa;### 3. SELinuxの無効化&#xa;1. **現在のSELinuxの状態確認**:&#xa;   - `getenforce`&#xa;   - &quot;Enforcing&quot; と表示されている場合は、SELinuxが有効です。&#xa;2. **SELinuxを無効にする**:&#xa;   - `sudo setenforce 0`&#xa;   - 恒久的に無効にするには、`/etc/selinux/config` ファイルを編集し、`SELINUX=disabled` に設定します。&#xa;&#xa;&#xa;### 4. OSアップデート&#xa;- **パッケージの更新**:&#xa;  - `sudo yum update`&#xa;  - これにより、CentOSとすべてのインストールされたパッケージが最新の状態に更新されます。&#xa;&#xa;&#xa;### 5. open-vm-toolsのインストール&#xa;- VMware環境でCentOSを実行している場合にのみ適用します。&#xa;- **open-vm-toolsのインストール**:&#xa;  - `sudo yum install open-vm-tools`&#xa;  - VMware上でのCentOSのパフォーマンスと管理を改善します。&#xa;  &#xa;[admin@localhost ~]$ rpm -q open-vm-tools&#xa;open-vm-tools-11.0.5-3.el7_9.7.x86_64" style="text;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="67" y="47" width="667" height="641" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="SSH" id="EZcLK18hInASVvrHGoVY">
    <mxGraphModel dx="1647" dy="839" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="BWevsbJ870ceWmd9wQKM-1" value="### 8. TeraTermからSSH接続確認&#xa;1. **Windows端末からTeraTermを起動**:&#xa;   - TeraTermをインストールしていない場合は、インストールが必要です。&#xa;2. **SSH接続設定**:&#xa;   - TeraTermの「新しい接続」で、CentOSサーバのIPアドレスまたはホスト名を入力します。&#xa;   - ポート番号をデフォルトの22から変更した場合は、変更したポート番号（例: 10022）を入力します。&#xa;3. **接続テスト**:&#xa;   - 「OK」をクリックして接続を試みます。成功すれば、ログインプロンプトが表示されます。&#xa;&#xa;&#xa;### 9. SSHセキュリティ設定&#xa;1. **SSHポートの変更**:&#xa;   - `sudo vi /etc/ssh/sshd_config` でSSH設定ファイルを開きます。&#xa;   - `Port 22` を `Port 10022`（または他のポート）に変更します。&#xa;   ===&#xa;   # If you want to change the port on a SELinux system, you have to tell&#xa;   # SELinux about this change.&#xa;   # semanage port -a -t ssh_port_t -p tcp #PORTNUMBER&#xa;   #&#xa;   Port 22&#xa;   Port 10022&#xa;   #AddressFamily any&#xa;   #ListenAddress 0.0.0.0&#xa;   #ListenAddress ::&#xa;   ===&#xa;2. **rootユーザの直接ログイン禁止**:&#xa;   - 同じファイルで `PermitRootLogin yes` を `PermitRootLogin no` に変更します。&#xa;3. **公開鍵認証の設定**:&#xa;   - teratermの鍵生成より、鍵を生成します。&#xa;   - 公開鍵をサーバの `vi ~/.ssh/authorized_keys` にコピーします。&#xa;4. **FirewalldでSSHポートを開放**:&#xa;   - `sudo firewall-cmd --permanent --add-port=10022/tcp` を実行します。&#xa;   - `sudo firewall-cmd --reload` で設定を適用します。&#xa;5. **SSHサービスの再起動**:&#xa;   - `sudo systemctl restart sshd`&#xa;&#xa;&#xa;### 10. サービス・ポート・ログ確認&#xa;1. **SSHサービスの状態確認**:&#xa;   - `systemctl status sshd` でSSHサービスの状態を確認します。&#xa;   ===&#xa;   [root@localhost ~]# systemctl status sshd&#xa;   ● sshd.service - OpenSSH server daemon&#xa;      Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: enabled)&#xa;      Active: active (running) since 金 2023-12-29 15:37:12 JST; 16s ago&#xa;   ===&#xa;2. **SSHポートの確認**:&#xa;   - `ss -tuln | grep 10022` でSSHポートがリスニングしているか確認します。&#xa;   ===&#xa;   [root@localhost ~]# ss -tuln | grep 10022&#xa;   tcp    LISTEN     0      128       *:10022                 *:*&#xa;   tcp    LISTEN     0      128    [::]:10022              [::]:*&#xa;   ===&#xa;   tcp LISTEN 0 128 *:10022 *:*: これはIPv4アドレスでSSHサーバがポート10022でリスニングしていることを示しています。&#xa;   tcp LISTEN 0 128 [::]:10022 [::]:*: これはIPv6アドレスでSSHサーバがポート10022でリスニングしていることを示しています。&#xa;&#xa;&#xa;3. **SSHアクセスログの確認**:&#xa;   - `sudo journalctl -u sshd` を実行してSSHのアクセスログを確認します。&#xa;   ===&#xa;   [root@localhost ~]# journalctl -u sshd&#xa;   -- Logs begin at 木 2023-12-28 14:40:23 JST, end at 金 2023-12-29 15:37:12 JST. --&#xa;   12月 29 13:51:01 localhost.localdomain systemd[1]: Starting OpenSSH server daemon...&#xa;   12月 29 13:51:02 localhost.localdomain sshd[1125]: Server listening on 0.0.0.0 port 22.&#xa;   12月 29 13:51:02 localhost.localdomain sshd[1125]: Server listening on :: port 22.&#xa;   12月 29 13:51:02 localhost.localdomain systemd[1]: Started OpenSSH server daemon.&#xa;   12月 29 13:52:03 localhost.localdomain sshd[1650]: Accepted password for admin from 192.168.230.1 port 60614 ssh2&#xa;   12月 29 15:37:12 localhost.localdomain systemd[1]: Stopping OpenSSH server daemon...&#xa;   12月 29 15:37:12 localhost.localdomain systemd[1]: Stopped OpenSSH server daemon.&#xa;   12月 29 15:37:12 localhost.localdomain systemd[1]: Starting OpenSSH server daemon...&#xa;   12月 29 15:37:12 localhost.localdomain sshd[2422]: Server listening on 0.0.0.0 port 10022.&#xa;   12月 29 15:37:12 localhost.localdomain sshd[2422]: Server listening on :: port 10022.&#xa;   12月 29 15:37:12 localhost.localdomain sshd[2422]: Server listening on 0.0.0.0 port 22.&#xa;   12月 29 15:37:12 localhost.localdomain sshd[2422]: Server listening on :: port 22.&#xa;   12月 29 15:37:12 localhost.localdomain systemd[1]: Started OpenSSH server daemon.&#xa;   ===" style="text;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="11" y="196.79" width="780" height="1173" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="cSdYDNsyQWn_zRzjIRta" name="ページ3">
    <mxGraphModel dx="1647" dy="839" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
